<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>分布式限流 | Java24K的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description" content="照亮你前行的路">
    
    <link rel="preload" href="/assets/css/0.styles.04215219.css" as="style"><link rel="preload" href="/assets/js/app.3642afc4.js" as="script"><link rel="preload" href="/assets/js/3.1617bc09.js" as="script"><link rel="preload" href="/assets/js/1.aed5c426.js" as="script"><link rel="preload" href="/assets/js/16.ce3ad6b4.js" as="script"><link rel="prefetch" href="/assets/js/10.a7a9d7ac.js"><link rel="prefetch" href="/assets/js/11.f8e85a78.js"><link rel="prefetch" href="/assets/js/12.7aaec106.js"><link rel="prefetch" href="/assets/js/13.12a453b5.js"><link rel="prefetch" href="/assets/js/14.b4a098d2.js"><link rel="prefetch" href="/assets/js/15.9946d53e.js"><link rel="prefetch" href="/assets/js/17.4e222b61.js"><link rel="prefetch" href="/assets/js/18.2c20195a.js"><link rel="prefetch" href="/assets/js/19.6a8a697a.js"><link rel="prefetch" href="/assets/js/20.97b0716c.js"><link rel="prefetch" href="/assets/js/21.3e0ca397.js"><link rel="prefetch" href="/assets/js/22.eb3dc6b2.js"><link rel="prefetch" href="/assets/js/23.c72877f0.js"><link rel="prefetch" href="/assets/js/24.44d9ac6f.js"><link rel="prefetch" href="/assets/js/25.a859aff2.js"><link rel="prefetch" href="/assets/js/26.13230ad3.js"><link rel="prefetch" href="/assets/js/27.a8a7d3dc.js"><link rel="prefetch" href="/assets/js/28.0aff8680.js"><link rel="prefetch" href="/assets/js/29.dbca541d.js"><link rel="prefetch" href="/assets/js/30.3e82e82c.js"><link rel="prefetch" href="/assets/js/31.96879229.js"><link rel="prefetch" href="/assets/js/32.e328e145.js"><link rel="prefetch" href="/assets/js/4.2dd6a149.js"><link rel="prefetch" href="/assets/js/5.e076944b.js"><link rel="prefetch" href="/assets/js/6.b377d7be.js"><link rel="prefetch" href="/assets/js/7.b5dc01a5.js"><link rel="prefetch" href="/assets/js/8.1b4012c7.js"><link rel="prefetch" href="/assets/js/9.2921b616.js">
    <link rel="stylesheet" href="/assets/css/0.styles.04215219.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Java24K的博客</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Java24K的博客</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Java24K的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      外站链接
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://study.java24k.com" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  技术摘抄网站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://t.zsxq.com/02RJI2ZJY" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  我的知识星球
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-042e23d4><!----> <h3 class="name" data-v-042e23d4>
    Java24K的博客
  </h3> <div class="num" data-v-042e23d4><div data-v-042e23d4><h3 data-v-042e23d4>0</h3> <h6 data-v-042e23d4>Article</h6></div> <div data-v-042e23d4><h3 data-v-042e23d4>0</h3> <h6 data-v-042e23d4>Tag</h6></div></div> <hr data-v-042e23d4></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      外站链接
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://study.java24k.com" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  技术摘抄网站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://t.zsxq.com/02RJI2ZJY" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  我的知识星球
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/distributed/分布式事务设计" class="sidebar-heading clickable open"><span>分布式系列</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distributed/分布式事务设计.html" class="sidebar-link">分布式事务设计</a></li><li><a href="/distributed/分布式锁设计.html" class="sidebar-link">分布式锁设计</a></li><li><a href="/distributed/分布式限流.html" class="active sidebar-link">分布式限流</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/distributed/分布式限流.html#一-限流目的" class="sidebar-link">一.限流目的</a></li><li class="sidebar-sub-header"><a href="/distributed/分布式限流.html#二-限流行为" class="sidebar-link">二.限流行为</a></li><li class="sidebar-sub-header"><a href="/distributed/分布式限流.html#三-限流分层" class="sidebar-link">三.限流分层</a></li></ul></li><li><a href="/distributed/分布式ID生成.html" class="sidebar-link">分布式ID生成</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/design/短链生成设计" class="sidebar-heading clickable"><span>系统设计系列</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/短链生成设计.html" class="sidebar-link">短链接生成设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/git/Github多账户配置" class="sidebar-heading clickable"><span>Git</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/git/Github命令集锦.html" class="sidebar-link">GitHub命令集锦</a></li><li><a href="/git/Github多账户配置.html" class="sidebar-link">Github多账户配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/java-base/Java注解" class="sidebar-heading clickable"><span>Java基础</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-base/Java注解.html" class="sidebar-link">Java注解</a></li><li><a href="/java-base/String全解析.html" class="sidebar-link">String全解析</a></li><li><a href="/java-base/StringBuilder与StringBuffer.html" class="sidebar-link">StringBuilder与StringBuffer</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>分布式限流</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Java24K的博客</span>
            
          <!---->
          2022
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>分布式限流</h1> <hr> <div data-v-34ea29db><i class="iconfont reco-account" data-v-34ea29db><span data-v-34ea29db>Java24K</span></i> <i class="iconfont reco-date" data-v-34ea29db><span data-v-34ea29db>2021-12-01</span></i> <i class="iconfont reco-eye" data-v-34ea29db><span id="/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%99%90%E6%B5%81.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-34ea29db><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="一-限流目的"><a href="#一-限流目的" class="header-anchor">#</a> 一.限流目的</h2> <ul><li>限流的目的是对并发访问进行限速，一旦达到限制的速率，那么就会触发相应的限流行为。</li></ul> <h2 id="二-限流行为"><a href="#二-限流行为" class="header-anchor">#</a> 二.限流行为</h2> <ol><li>拒绝服务：把多出来的请求拒绝掉，受到流量暴增的时候，会统计当前的哪个客户端来的请求最多，直接进行拒绝，把带恶意的请求阻挡。</li> <li>服务降级：关闭一些不太重要的服务，让给更重要的功能。另一种是返回部分数据。</li> <li>特权请求：我们只把有限的资源分给重要的用户，我们应该把资源尽可能的分给特权用户。</li> <li>延时队列：利用一个队列来进行缓冲大量的请求，如果队列满，则进行拒绝，一般用于应对短暂的峰刺请求。</li> <li>弹性伸缩：动用自动化运维的方式对相应的服务做自动化的伸缩。这个需要一个应用性能的监控系统，能够感知到目前最繁忙的 TOP 5 的服务是哪几个。</li></ol> <h2 id="三-限流分层"><a href="#三-限流分层" class="header-anchor">#</a> 三.限流分层</h2> <h3 id="接入层限流"><a href="#接入层限流" class="header-anchor">#</a> 接入层限流</h3> <ul><li>Nginx 连接数限流模块limit_conn 限制瞬时并发数量，每秒请求达到一定频率，可以扔到自定义503页面。</li> <li>Nginx 请求限流模块limit_req 限制每秒请求数，每秒请求达到一定频率，可以扔到自定义502页面。</li></ul> <h3 id="应用层限流"><a href="#应用层限流" class="header-anchor">#</a> 应用层限流</h3> <ul><li>tomcat 配置最大连接数、队列处理请求数等参数， acceptCount默认100 、maxThreads 默认200。</li></ul> <h3 id="api层限流"><a href="#api层限流" class="header-anchor">#</a> API层限流</h3> <h4 id="固定窗口算法"><a href="#固定窗口算法" class="header-anchor">#</a> 固定窗口算法</h4> <ul><li>概念：也叫计数器算法，是使用计数器在周期内累加访问次数，当达到设定的限流值时，触发限流策略。下一个周期开始时，进行清零，重新计数。</li> <li>实现方式：此算法在单机还是分布式环境下实现都非常简单，使用redis的incr原子自增性和线程安全即可轻松实现。这个算法通常用于QPS限流和统计总访问量，对于秒级以上的时间周期来说，会存在一个非常严重的问题，那就是临界问题。假设1min内服务器的负载能力为100，因此一个周期的访问量限制在100，然而在第一个周期的最后5秒和下一个周期的开始5秒时间段内，分别涌入100的访问量，虽然没有超过每个周期的限制量，但是整体上10秒内已达到200的访问量，已远远超过服务器的负载能力，由此可见，计数器算法方式限流对于周期比较长的限流，存在很大的弊端。</li></ul> <h4 id="滑动窗口算法"><a href="#滑动窗口算法" class="header-anchor">#</a> 滑动窗口算法</h4> <ul><li>滑动窗口算法是将时间周期分为N个小周期，分别记录每个小周期内访问次数，并且根据时间滑动删除过期的小周期。假设时间周期为1min，将1min再分为2个小周期，统计每个小周期的访问数量，则可以看到，第一个时间周期内，访问数量为75，第二个时间周期内，访问数量为100，超过100的访问则被限流掉了。由此可见，当滑动窗口的格子划分的越多，那么滑动窗口的滚动就越平滑，限流的统计就会越精确。此算法可以很好的解决固定窗口算法的临界问题。
<img src="data:image/png;base64,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" alt="滑动窗口"></li></ul> <h4 id="漏桶算法"><a href="#漏桶算法" class="header-anchor">#</a> 漏桶算法</h4> <ul><li>漏桶算法是访问请求到达时直接放入漏桶，如当前容量已达到上限（限流值），则进行丢弃（触发限流策略）。漏桶以固定的速率进行释放访问请求（即请求通过），直到漏桶为空。
<img src="/assets/img/leakyBucket.f6bd51d6.png" alt="漏桶"></li></ul> <h4 id="令牌桶算法"><a href="#令牌桶算法" class="header-anchor">#</a> 令牌桶算法</h4> <ul><li>令牌桶算法是程序以r（r=时间周期/限流值）的速度向令牌桶中增加令牌，直到令牌桶满，请求到达时向令牌桶请求令牌，如获取到令牌则通过请求，否则触发限流策略令牌桶算法在限流之外，允许一定程度的突发流量。</li></ul> <p><img src="/assets/img/tokenBucket.d5bfbfe8.png" alt="令牌桶"></p> <blockquote><p>文章参考</p></blockquote> <ul><li>https://blog.52itstyle.vip/archives/2982/</li></ul></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.3642afc4.js" defer></script><script src="/assets/js/3.1617bc09.js" defer></script><script src="/assets/js/1.aed5c426.js" defer></script><script src="/assets/js/16.ce3ad6b4.js" defer></script>
  </body>
</html>
