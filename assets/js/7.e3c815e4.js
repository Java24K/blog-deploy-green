(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{625:function(t,e,a){t.exports=a.p+"assets/img/authorizationCode001.cfcabb98.png"},626:function(t,e,a){t.exports=a.p+"assets/img/authorizationCode002.3b912d9d.png"},627:function(t,e,a){t.exports=a.p+"assets/img/authorizationCode003.bbc79ccc.png"},628:function(t,e,a){t.exports=a.p+"assets/img/authorizationCode004.e7f7b1ec.png"},629:function(t,e,a){t.exports=a.p+"assets/img/authorizationCode005.57e838ab.png"},630:function(t,e,a){t.exports=a.p+"assets/img/authorizationCode006.5d0d03b7.png"},663:function(t,e,a){"use strict";a.r(e);var l=a(10),_=Object(l.a)({},(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[l("blockquote",[l("p",[t._v("写在前面：Oauth2系列配套视频地址 https://t.hk.uy/bdr8")])]),t._v(" "),l("h2",{attrs:{id:"一-概念"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#一-概念"}},[t._v("#")]),t._v(" 一.概念")]),t._v(" "),l("p",[l("strong",[t._v('授权码模式（authorization code）是功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与"服务提供商"的认证服务器进行互动。先申请一个授权码，然后再用该码获取令牌。')]),t._v(" "),l("br")]),t._v(" "),l("h2",{attrs:{id:"二-适用场景"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#二-适用场景"}},[t._v("#")]),t._v(" 二.适用场景")]),t._v(" "),l("p",[l("strong",[t._v("1.  需要得到长期授权")])]),t._v(" "),l("p",[l("strong",[t._v("2. OAuth客户端是Web应用服务器")])]),t._v(" "),l("p",[l("strong",[t._v("3. OAuth访问令牌不宜泄露给用户的环境")])]),t._v(" "),l("p",[l("strong",[t._v("适用于需要从web server访问的应用，例如Web/wap网站。")]),t._v(" "),l("br")]),t._v(" "),l("h2",{attrs:{id:"三-示意图与时序图"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#三-示意图与时序图"}},[t._v("#")]),t._v(" 三.示意图与时序图")]),t._v(" "),l("p",[l("strong",[t._v("授权验证流程示意图")])]),t._v(" "),l("p",[l("img",{attrs:{src:a(625),alt:"clipboard.png"}})]),t._v(" "),l("p",[l("strong",[t._v("A-A-B-B-C-C-D-E")])]),t._v(" "),l("p",[l("strong",[t._v("（A）用户访问客户端，客户端将用户重定向到认证服务器。")])]),t._v(" "),l("p",[l("strong",[t._v("（B）用户选择是否给予客户端授权。")])]),t._v(" "),l("p",[l("strong",[t._v('（C）假设用户给予授权，认证服务器将用户导向客户端事先指定的"重定向URI"（redirection URI），同时附上一个授权码。')])]),t._v(" "),l("p",[l("strong",[t._v('（D）客户端收到授权码，附上早先的"重定向URI"，向认证服务器申请令牌。这一步是在客户端的后台的服务器上完成的，对用户不可见。')])]),t._v(" "),l("p",[l("strong",[t._v("（E）认证服务器核对了授权码和重定向URI，确认无误后，向客户端发送访问令牌（access token）和更新令牌（refresh token）。")])]),t._v(" "),l("p",[l("strong",[t._v("授权验证流程时序图")])]),t._v(" "),l("p",[l("img",{attrs:{src:a(626),alt:"image.png"}}),t._v(" "),l("br")]),t._v(" "),l("h2",{attrs:{id:"四-流程与参数详解"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#四-流程与参数详解"}},[t._v("#")]),t._v(" 四.流程与参数详解")]),t._v(" "),l("p",[l("strong",[t._v("A步骤中，客户端申请认证的URI，包含以下参数：")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("参数名称")])]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("描述")])])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("response_type")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("必填。将其值设置为code表示如果成功的话将收到一个授权码。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("client_id")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("必填。客户端标识。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("redirect_uri")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("可选。重定向URI虽然不是必须的，但是你的服务应该会需要它。而且，这个URL必须和授权服务端注册的redirect_id一致。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("scope")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("可选。请求可能会有一个或多个scope值。授权服务器会把客户端请求的范围(scope)展示给用户看。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("state")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("推荐。state参数用于应用存储特定的请求数据的可以防止CSRF攻击。授权服务器必须原封不动地将这个值返回给应用。")])])])]),t._v(" "),l("p",[l("strong",[t._v("C步骤中，服务器回应客户端的URI，包含以下参数：")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("参数名称")])]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("描述")])])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("code")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示授权码，必选项。该码的有效期应该很短，通常设为10分钟，客户端只能使用该码一次，否则会被授权服务器拒绝。该码与客户端ID和重定向URI，是一一对应关系。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("state")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("如果客户端的请求中包含这个参数，认证服务器的回应也必须一模一样包含这个参数。")])])])]),t._v(" "),l("p",[l("strong",[t._v("D步骤中，客户端向认证服务器申请令牌的HTTP请求，包含以下参数：")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("参数名称")])]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("描述")])])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("grant_type")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v('表示使用的授权模式，必选项，此处的值固定为"authorization_code"')])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("code")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示上一步获得的授权码，必选项。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("redirect_uri")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示重定向URI，必选项，且必须与A步骤中的该参数值保持一致。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("client_id")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示客户端ID，必选项。")])])])]),t._v(" "),l("p",[l("strong",[t._v("E步骤中，认证服务器发送的HTTP回复，包含以下参数：")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("参数名称")])]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[l("strong",[t._v("描述")])])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("access_token")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示访问令牌，必选项。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("token_type")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示令牌类型，该值大小写不敏感，必选项，可以是bearer类型或mac类型。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("expires_in")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示过期时间，单位为秒。如果省略该参数，必须其他方式设置过期时间。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("refresh_token")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示更新令牌，用来获取下一次的访问令牌，可选项。")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("scope")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("表示权限范围，如果与客户端申请的范围一致，此项可省略。")])])])]),t._v(" "),l("br"),t._v(" "),l("h2",{attrs:{id:"五-实例演示解析"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#五-实例演示解析"}},[t._v("#")]),t._v(" 五.实例演示解析")]),t._v(" "),l("p",[t._v("GitHub地址：")]),t._v(" "),l("ol",[l("li",[t._v("请求授权端点获得授权码")])]),t._v(" "),l("p",[l("a",{attrs:{href:"http://localhost:8080/oauth/authorize?response_type=code&client_id=my-client-1&redirect_uri=http://www.baidu.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:8080/oauth/authorize?response_type=code&client_id=my-client-1&redirect_uri=http://www.baidu.com"),l("OutboundLink")],1)]),t._v(" "),l("p",[l("img",{attrs:{src:a(627),alt:"image.png"}})]),t._v(" "),l("ol",{attrs:{start:"2"}},[l("li",[t._v("请求令牌端点根据授权码拿到token")])]),t._v(" "),l("p",[l("a",{attrs:{href:"http://localhost:8080/oauth/token",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:8080/oauth/token"),l("OutboundLink")],1)]),t._v(" "),l("p",[l("img",{attrs:{src:a(628),alt:"image.png"}})]),t._v(" "),l("ol",{attrs:{start:"3"}},[l("li",[t._v("拿着令牌访问资源")])]),t._v(" "),l("p",[t._v("http://localhost:8080/oauth2/hi?access_token=c244445f-1cb0-4971-a4ce-c31b4f470ee3")]),t._v(" "),l("p",[l("img",{attrs:{src:a(629),alt:"image.png"}})]),t._v(" "),l("ol",{attrs:{start:"4"}},[l("li",[t._v("刷新token")])]),t._v(" "),l("p",[l("a",{attrs:{href:"http://localhost:8080/oauth/token",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:8080/oauth/token"),l("OutboundLink")],1)]),t._v(" "),l("p",[l("img",{attrs:{src:a(630),alt:"image.png"}})])])}),[],!1,null,null,null);e.default=_.exports}}]);