(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{605:function(e,r,t){e.exports=t.p+"assets/img/002-001.575b8a6a.png"},606:function(e,r,t){e.exports=t.p+"assets/img/002-002.2fd795bf.png"},651:function(e,r,t){"use strict";t.r(r);var s=t(10),v=Object(s.a)({},(function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"一、证书相关概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、证书相关概念"}},[e._v("#")]),e._v(" 一、证书相关概念")]),e._v(" "),s("p",[s("strong",[e._v("CA(Certificate Authority)：被称为证书授权中心是数字证书发放和管理的机构。签发主流机构：Symantec、Thawte、GeoTrust、GlobalSign等。")])]),e._v(" "),s("p",[s("strong",[e._v("根证书：CA证书授权中心给自己颁发的证书, 是信任链的起始点。安装根证书意味着对这个CA认证中心的信任。权威CA机构的根证书内置于浏览器中。")])]),e._v(" "),s("p",[s("strong",[e._v("数字证书颁发过程：用户首先产生自己的密钥对，并将公共密钥及部分个人身份信息传送给认证中心。认证中心在核实身份后，将执行一些必要的步骤，以确信请求确实由用户发送而来，然后，认证中心将发给用户一个数字证书，")])]),e._v(" "),s("p",[s("img",{attrs:{src:t(605),alt:"image.png"}})]),e._v(" "),s("br"),e._v(" "),s("p",[e._v("客户端验证服务器证书")]),e._v(" "),s("p",[s("strong",[e._v("Openssl ：目前最流行的 SSL 密码库工具，其提供了一个通用、健壮、功能完备的工具套件，用以支持SSL/TLS 协议的实现。")])]),e._v(" "),s("p",[s("strong",[e._v("X.509：是被广泛使用的数字证书标准，是用于标志通讯各方身份信息的一系列数据。")])]),e._v(" "),s("p",[s("strong",[e._v("X.509证书包含三个文件：key(私钥)，csr(生成数字证书请求文件)，cer/crt(是用于存放证书的签名文件，以二进制形式存放，不含私钥)。")])]),e._v(" "),s("br"),e._v(" "),s("h2",{attrs:{id:"二、生成数字证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、生成数字证书"}},[e._v("#")]),e._v(" 二、生成数字证书")]),e._v(" "),s("p",[s("strong",[e._v("我们需要 自签根证书、服务端证书、服务端私钥、客户端证书。")])]),e._v(" "),s("p",[s("strong",[e._v("注意：Openssl使用1.0.2版本，否则生成请求文件会报错。")])]),e._v(" "),s("p",[s("strong",[e._v("1. 创建根证私钥")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> genrsa -out root-key.key 1024")])]),e._v(" "),s("p",[s("strong",[e._v("说明：生成rsa私钥，1024位长度，输出到root-key.key。")])]),e._v(" "),s("p",[s("strong",[e._v("2. 创建根证书请求文件")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> req -new -out root-req.csr -key root-key.key")])]),e._v(" "),s("p",[s("strong",[e._v("说明：会让填写信息,其中国家,省市,公司等需要和后面的证书保持一致.后面challenge password的地方直接回车就好。")])]),e._v(" "),s("p",[s("strong",[e._v("3. 生成自签根证书")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> x509 -req -in root-req.csr -out root-cert.cer -signkey root-key.key -CAcreateserial -days 3650")])]),e._v(" "),s("p",[s("strong",[e._v("5. 生成服务端私钥")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> genrsa -out server-key.key 1024")])]),e._v(" "),s("p",[s("strong",[e._v("6. 生成服务端请求文件")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> req -new -out server-req.csr -key server-key.key")])]),e._v(" "),s("p",[s("strong",[e._v("说明：国家省市公司和2)保持一致, Common Name 要特别注意, 要用你服务器的域名,我们测试用zhoufeng.com")])]),e._v(" "),s("p",[s("strong",[e._v("7. 生成服务端证书（root-cert.cer，root-key.key，server-key.key，server-req.csr 这4个文件来生成服务端证书）")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> x509 -req -in server-req.csr -out server-cert.cer -signkey server-key.key -CA root-cert.cer -CAkey root-key.key -CAcreateserial -days 3650")])]),e._v(" "),s("p",[s("strong",[e._v("8. 生成客户端key")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> genrsa -out client-key.key 1024")])]),e._v(" "),s("p",[s("strong",[e._v("9. 生成客户端请求文件")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> req -new -out client-req.csr -key client-key.key")])]),e._v(" "),s("p",[s("strong",[e._v("10. 生成客户端证书（root证书，rootkey，client-key.key，client-req.csr这4个生成文件生成客户端证书）")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> x509 -req -in client-req.csr -out client-cert.cer -signkey client-key.key -CA root-cert.cer -CAkey root-key.key -CAcreateserial -days 3650")])]),e._v(" "),s("p",[s("strong",[e._v("11. 生成客户端p12格式根证书(密码设置123456)")])]),e._v(" "),s("p",[s("strong",[e._v("OpenSSL> pkcs12 -export -clcerts -in client-cert.cer -inkey client-key.key -out client.p12")])]),e._v(" "),s("p",[s("strong",[e._v("备注：参数名称和意义")])]),e._v(" "),s("p",[s("strong",[e._v("genrsa         产生RSA密钥命令")])]),e._v(" "),s("p",[s("strong",[e._v("req                产生证书签发申请命令")])]),e._v(" "),s("p",[s("strong",[e._v("x509            签发X.509格式证书命令")])]),e._v(" "),s("p",[s("strong",[e._v("pkcs12         PKCS#12编码格式证书命令。")])]),e._v(" "),s("p",[s("strong",[e._v("-in                 表示输入文件")])]),e._v(" "),s("p",[s("strong",[e._v("-out              表示输出文件")])]),e._v(" "),s("p",[s("strong",[e._v("-req              表示证书输入请求。")])]),e._v(" "),s("p",[s("strong",[e._v("-export        表示导出证书")])]),e._v(" "),s("p",[s("strong",[e._v("-inkey           表示输入私钥文件")])]),e._v(" "),s("p",[s("strong",[e._v("-days            表示有效天数")])]),e._v(" "),s("p",[s("strong",[e._v("-CAcreateserial   表示创建CA证书序列号")])]),e._v(" "),s("p",[s("strong",[e._v("-CAkey         表示CA证书私钥")])]),e._v(" "),s("p",[s("strong",[e._v("-CA                表示CA证书")])]),e._v(" "),s("p",[s("strong",[e._v("-signkey       表示自签名私钥")])]),e._v(" "),s("p",[s("strong",[e._v("-new              表示新请求")])]),e._v(" "),s("p",[s("strong",[e._v("-clcerts        表示仅导出客户证书。")])]),e._v(" "),s("br"),e._v(" "),s("h2",{attrs:{id:"三、配置nginx服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、配置nginx服务"}},[e._v("#")]),e._v(" 三、配置nginx服务")]),e._v(" "),s("p",[s("strong",[e._v("重定向http请求")])]),e._v(" "),s("p",[s("code"),e._v("server {")]),e._v(" "),s("p",[s("code"),e._v("listen       80;")]),e._v(" "),s("p",[s("code"),e._v("server_name  127.0.0.1;")]),e._v(" "),s("p",[s("code"),e._v("rewrite ^(.*)$  https://$host$1;   # 强制转https")]),e._v(" "),s("p",[s("code"),e._v("}")]),e._v(" "),s("p",[s("strong",[e._v("创建监听443端口服务")])]),e._v(" "),s("p",[s("code"),e._v("server {")]),e._v(" "),s("p",[s("code"),e._v("listen       443 ssl;")]),e._v(" "),s("p",[s("code"),e._v("server_name  zhoufeng.com;")]),e._v(" "),s("p",[s("code"),e._v("ssl_certificate      /Users/finup/downloads/httpsDouble/server-cert.cer; #server证书公钥")]),e._v(" "),s("p",[s("code"),e._v("ssl_certificate_key  /Users/finup/downloads/httpsDouble/server-key.key; #server私钥")]),e._v(" "),s("p",[s("code"),e._v("ssl_client_certificate /Users/finup/downloads/httpsDouble/root-cert.cer;  #根级证书公钥，用于验证各个二级client certificate")]),e._v(" "),s("p",[s("code"),e._v("ssl_verify_client on; #启用客户端证书审核")]),e._v(" "),s("p",[s("code"),e._v("ssl_session_cache    shared:SSL:10m; #设置储存SSL会话的缓存类型和大小")]),e._v(" "),s("p",[s("code"),e._v("ssl_session_timeout  10m; #设置客户端能够反复使用储存在缓存中的会话参数时间")]),e._v(" "),s("p",[s("code"),e._v("ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #指定要使用的SSL协议")]),e._v(" "),s("p",[s("code"),e._v("location / {")]),e._v(" "),s("p",[s("code"),e._v("root  /Users/finup/downloads/code;")]),e._v(" "),s("p",[s("code"),e._v("index  index.html;")]),e._v(" "),s("p",[s("code"),e._v("}")]),e._v(" "),s("p",[s("code"),e._v("}")]),e._v(" "),s("br"),e._v(" "),s("h2",{attrs:{id:"四、配置host域名解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、配置host域名解析"}},[e._v("#")]),e._v(" 四、配置Host域名解析")]),e._v(" "),s("p",[s("img",{attrs:{src:t(606),alt:"image.png"}})]),e._v(" "),s("br"),e._v(" "),s("h2",{attrs:{id:"五、安装客户端证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、安装客户端证书"}},[e._v("#")]),e._v(" 五、安装客户端证书")]),e._v(" "),s("p",[s("strong",[e._v("Windows／Mac 双击client.p12进行安装")])]),e._v(" "),s("p",[s("strong",[e._v("备注：不同的客户端证书通过Common Name 和 Email Address区分")])])])}),[],!1,null,null,null);r.default=v.exports}}]);